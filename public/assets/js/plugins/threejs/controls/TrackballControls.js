THREE.TrackballControls=function(e,t){var o=this,n=-1,s=0,c=1,a=2,i=3,r=4;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var p=new THREE.Vector3,h=n,d=n,u=new THREE.Vector3,m=new THREE.Vector2,l=new THREE.Vector2,E=new THREE.Vector3,g=0,y=new THREE.Vector2,v=new THREE.Vector2,w=0,b=0,f=new THREE.Vector2,R=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var T={type:"change"},L={type:"start"},V={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}};var H,k,j,D,Y,X,C,S,x,P,z,M=(H=new THREE.Vector2,function(e,t){return H.set((e-o.screen.left)/o.screen.width,(t-o.screen.top)/o.screen.height),H}),q=function(){var e=new THREE.Vector2;return function(t,n){return e.set((t-.5*o.screen.width-o.screen.left)/(.5*o.screen.width),(o.screen.height+2*(o.screen.top-n))/o.screen.width),e}}();function Z(e){!1!==o.enabled&&(window.removeEventListener("keydown",Z),d=h,h===n&&(e.keyCode!==o.keys[s]||o.noRotate?e.keyCode!==o.keys[c]||o.noZoom?e.keyCode!==o.keys[a]||o.noPan||(h=a):h=c:h=s))}function A(e){!1!==o.enabled&&(h=d,window.addEventListener("keydown",Z,!1))}function F(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),h===n&&(h=e.button),h!==s||o.noRotate?h!==c||o.noZoom?h!==a||o.noPan||(f.copy(M(e.pageX,e.pageY)),R.copy(f)):(y.copy(M(e.pageX,e.pageY)),v.copy(y)):(l.copy(q(e.pageX,e.pageY)),m.copy(l)),document.addEventListener("mousemove",Q,!1),document.addEventListener("mouseup",O,!1),o.dispatchEvent(L))}function Q(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),h!==s||o.noRotate?h!==c||o.noZoom?h!==a||o.noPan||R.copy(M(e.pageX,e.pageY)):v.copy(M(e.pageX,e.pageY)):(m.copy(l),l.copy(q(e.pageX,e.pageY))))}function O(e){!1!==o.enabled&&(e.preventDefault(),e.stopPropagation(),h=n,document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",O),o.dispatchEvent(V))}function B(e){if(!1!==o.enabled&&!0!==o.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:y.y-=.025*e.deltaY;break;case 1:y.y-=.01*e.deltaY;break;default:y.y-=25e-5*e.deltaY}o.dispatchEvent(L),o.dispatchEvent(V)}}function W(e){if(!1!==o.enabled){switch(e.preventDefault(),e.touches.length){case 1:h=i,l.copy(q(e.touches[0].pageX,e.touches[0].pageY)),m.copy(l);break;default:h=r;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;b=w=Math.sqrt(t*t+n*n);var s=(e.touches[0].pageX+e.touches[1].pageX)/2,c=(e.touches[0].pageY+e.touches[1].pageY)/2;f.copy(M(s,c)),R.copy(f)}o.dispatchEvent(L)}}function G(e){if(!1!==o.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:m.copy(l),l.copy(q(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;b=Math.sqrt(t*t+n*n);var s=(e.touches[0].pageX+e.touches[1].pageX)/2,c=(e.touches[0].pageY+e.touches[1].pageY)/2;R.copy(M(s,c))}}function I(e){if(!1!==o.enabled){switch(e.touches.length){case 0:h=n;break;case 1:h=i,l.copy(q(e.touches[0].pageX,e.touches[0].pageY)),m.copy(l)}o.dispatchEvent(V)}}function J(e){!1!==o.enabled&&e.preventDefault()}this.rotateCamera=(j=new THREE.Vector3,D=new THREE.Quaternion,Y=new THREE.Vector3,X=new THREE.Vector3,C=new THREE.Vector3,S=new THREE.Vector3,function(){S.set(l.x-m.x,l.y-m.y,0),(k=S.length())?(u.copy(o.object.position).sub(o.target),Y.copy(u).normalize(),X.copy(o.object.up).normalize(),C.crossVectors(X,Y).normalize(),X.setLength(l.y-m.y),C.setLength(l.x-m.x),S.copy(X.add(C)),j.crossVectors(S,u).normalize(),k*=o.rotateSpeed,D.setFromAxisAngle(j,k),u.applyQuaternion(D),o.object.up.applyQuaternion(D),E.copy(j),g=k):!o.staticMoving&&g&&(g*=Math.sqrt(1-o.dynamicDampingFactor),u.copy(o.object.position).sub(o.target),D.setFromAxisAngle(E,g),u.applyQuaternion(D),o.object.up.applyQuaternion(D)),m.copy(l)}),this.zoomCamera=function(){var e;h===r?(e=w/b,w=b,u.multiplyScalar(e)):(1!==(e=1+(v.y-y.y)*o.zoomSpeed)&&e>0&&u.multiplyScalar(e),o.staticMoving?y.copy(v):y.y+=(v.y-y.y)*this.dynamicDampingFactor)},this.panCamera=(x=new THREE.Vector2,P=new THREE.Vector3,z=new THREE.Vector3,function(){x.copy(R).sub(f),x.lengthSq()&&(x.multiplyScalar(u.length()*o.panSpeed),z.copy(u).cross(o.object.up).setLength(x.x),z.add(P.copy(o.object.up).setLength(x.y)),o.object.position.add(z),o.target.add(z),o.staticMoving?f.copy(R):f.add(x.subVectors(R,f).multiplyScalar(o.dynamicDampingFactor)))}),this.checkDistances=function(){o.noZoom&&o.noPan||(u.lengthSq()>o.maxDistance*o.maxDistance&&(o.object.position.addVectors(o.target,u.setLength(o.maxDistance)),y.copy(v)),u.lengthSq()<o.minDistance*o.minDistance&&(o.object.position.addVectors(o.target,u.setLength(o.minDistance)),y.copy(v)))},this.update=function(){u.subVectors(o.object.position,o.target),o.noRotate||o.rotateCamera(),o.noZoom||o.zoomCamera(),o.noPan||o.panCamera(),o.object.position.addVectors(o.target,u),o.checkDistances(),o.object.lookAt(o.target),p.distanceToSquared(o.object.position)>1e-6&&(o.dispatchEvent(T),p.copy(o.object.position))},this.reset=function(){h=n,d=n,o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.up.copy(o.up0),u.subVectors(o.object.position,o.target),o.object.lookAt(o.target),o.dispatchEvent(T),p.copy(o.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",J,!1),this.domElement.removeEventListener("mousedown",F,!1),this.domElement.removeEventListener("wheel",B,!1),this.domElement.removeEventListener("touchstart",W,!1),this.domElement.removeEventListener("touchend",I,!1),this.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",Q,!1),document.removeEventListener("mouseup",O,!1),window.removeEventListener("keydown",Z,!1),window.removeEventListener("keyup",A,!1)},this.domElement.addEventListener("contextmenu",J,!1),this.domElement.addEventListener("mousedown",F,!1),this.domElement.addEventListener("wheel",B,!1),this.domElement.addEventListener("touchstart",W,!1),this.domElement.addEventListener("touchend",I,!1),this.domElement.addEventListener("touchmove",G,!1),window.addEventListener("keydown",Z,!1),window.addEventListener("keyup",A,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls;